Hi,
Thanks for the feedback!

1. Oh, very good. My C roots are showing.

2. Yes! Look at that, much nicer.

3. Indeed; I imagine that performance could be greatly improved by doing this. That's a larger revision, so I'll put that up later.

Submitting some revisions now.
